(this["webpackJsonptimesheet-maker"]=this["webpackJsonptimesheet-maker"]||[]).push([[0],{29:function(e,t,n){},30:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),o=n.n(a),i=n(21),c=n.n(i),s=(n(29),n(7)),u=n(11),l=n(2);n(30);function d(e,t){return e.toISOString()===t.toISOString()}function m(e,t){return e.some((function(e){return d(e,t)}))}function b(e){return JSON.parse(e,(function(e,t){return e.toLowerCase().endsWith("date")||e.toLowerCase().endsWith("time")?new Date(t):t}))}function p(e){var t=h(e,-e.getDay());return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function f(e,t,n,r){var a=new Date(e);return a.setHours(t),a.setMinutes(n),a.setSeconds(r),a.setMilliseconds(0),a}function h(e,t,n,r,a){return new Date(e.getTime()+24*(null!==t&&void 0!==t?t:0)*60*60*1e3+60*(null!==n&&void 0!==n?n:0)*60*1e3+60*(null!==r&&void 0!==r?r:0)*1e3+1e3*(null!==a&&void 0!==a?a:0))}function j(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?"/".concat(e.getFullYear()):"";return"".concat(e.getDate(),"/").concat(e.getMonth()+1)+n}function T(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=p(e);return"".concat(j(n,t)," \u2013 ").concat(j(h(n,7),t))}var O=n(23),v="timeSheetDates";function S(){var e=localStorage.getItem(v);return null===e?[]:b(e).map((function(e){return new Date(e)}))}function g(e){e.forEach(C),localStorage.setItem(v,JSON.stringify(e))}function w(e){C(e);var t=S();m(t,e)||g([e].concat(Object(O.a)(t)))}function y(e){C(e),g(S().filter((function(t){return!d(e,t)})))}function D(e,t){C(e),localStorage.setItem("timeSheet-".concat(e.toISOString()),JSON.stringify(t)),w(e)}function x(e){C(e);var t=localStorage.getItem("timeSheet-".concat(e.toISOString()));return null===t?null:b(t)}function k(e){return C(e),y(e),!!function(e){return C(e),null!==localStorage.getItem("timeSheet-".concat(e.toISOString()))}(e)&&(localStorage.removeItem("timeSheet-".concat(e.toISOString())),!0)}function C(e){if(!d(e,p(e)))throw new Error("Date ".concat(e," does not match start of week ").concat(p(e)))}var M,N=n(8);!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(M||(M={}));var P=[M.Sunday,M.Monday,M.Tuesday,M.Wednesday,M.Thursday,M.Friday,M.Saturday];function E(e){return{weekStartDate:p(e),timeTablePropsMap:{}}}function I(e,t,n){return{personName:t,timeTablePos:n,date:e.date,dayColumnsProps:P.reduce((function(n,r){return n[r]=function(e,t,n){var r=h(f(e.date,8,0,0),n),a=h(r,0,0,30);return{personName:t,isDayOff:!0,dow:n,startTime:r,endTime:a,breaksLength:0}}(e,t,r),n}),{})}}function U(e,t){return Object(N.a)(Object(N.a)({},e),{},{date:t,dayColumnsProps:P.reduce((function(n,r){return n[r]=function(e,t,n){var r=h(n,t);return Object(N.a)(Object(N.a)({},e),{},{startTime:f(r,e.startTime.getHours(),e.startTime.getMinutes(),e.startTime.getSeconds()),endTime:f(r,e.endTime.getHours(),e.endTime.getMinutes(),e.endTime.getSeconds())})}(e.dayColumnsProps[r],r,t),n}),{})})}var F="None";function A(e){var t=Object(a.useState)(new Date(Date.now())),n=Object(s.a)(t,2),o=n[0],i=n[1],c=Object(a.useState)(!1),u=Object(s.a)(c,2),d=u[0],b=u[1],f=Object(a.useState)(F),O=Object(s.a)(f,2),v=O[0],S=O[1];return Object(r.jsxs)(r.Fragment,{children:[d&&Object(r.jsx)(l.a,{to:"/".concat(o.toISOString())}),Object(r.jsx)("h2",{children:"Home"}),Object(r.jsxs)("form",{onSubmit:function(t){return function(e,t,n,r,a,o){e.preventDefault(),H(a,o);var i=p(t);if(m(a,i))return void alert("Time sheet already exists for ".concat(j(t)," (week ").concat(T(i),")"));if(o!==F){var c=R(a,o),s=x(c);if(null===s)throw new Error("Saved week ".concat(T(c)," has no local saved data"));D(i,function(e,t){var n={};for(var r in e.timeTablePropsMap)n[r]=U(e.timeTablePropsMap[r],t);return Object(N.a)(Object(N.a)({},e),{},{weekStartDate:p(t),timeTablePropsMap:n})}(s,i))}r(i),n(!0)}(t,o,b,e.addTimeSheetDate,e.timeSheetDates,v)},children:[Object(r.jsx)("label",{htmlFor:"date",children:"Date:"}),Object(r.jsx)("input",{name:"date",type:"date",value:L(o),onChange:function(e){return function(e,t){var n=e.target.valueAsDate;if(null===n)throw new Error("Failed to set date in ".concat(A.name));var r=h(n,0,0,n.getTimezoneOffset());t(r)}(e,i)}}),Object(r.jsx)("label",{htmlFor:"copyFrom",children:"Copy from:"}),Object(r.jsxs)("select",{value:v,onChange:function(t){return function(e,t,n){var r=t.target.value;if(null===r)throw new Error("Failed to set 'copy from' time sheet in ".concat(A.name));H(e,r),n(r)}(e.timeSheetDates,t,S)},children:[Object(r.jsx)("option",{value:F,children:"None"},F),e.timeSheetDates.map((function(e){return Object(r.jsx)("option",{value:e.toISOString(),children:T(e,!0)},e.toISOString())}))]}),Object(r.jsx)("input",{type:"submit",value:"Add new time sheet"})]})]})}function L(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function H(e,t){if(t!==F&&!R(e,t))throw new Error("Selected time sheet week ".concat(t," is not none or an existing week"))}function R(e,t){var n=e.filter((function(e){return e.toISOString()===t}));if(1!==n.length)throw new Error("".concat(t," matches ").concat(n.length," dates from ").concat(e,", expected 1 match"));return n[0]}var B=A;var W=function(e){return Object(r.jsx)("input",{className:"timeCellInput",type:"time",min:"08:00:00",max:"21:00:00",step:900,value:function(e){var t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),r=e.getSeconds().toString().padStart(2,"0");return"".concat(t,":").concat(n,":").concat(r)}(e.time),placeholder:"Set the time",onChange:function(t){return function(t){var n=t.target.valueAsDate;if(null===n)return;var r=new Date(e.time);r.setHours(n.getUTCHours()),r.setMinutes(n.getUTCMinutes()),r.setSeconds(n.getUTCSeconds()),r.setMilliseconds(n.getUTCMilliseconds()),e.onTimeChange(r)}(t)}})};function J(e){if(void 0!==e.onNumberChange)return function(t){e.onNumberChange(t.target.valueAsNumber)};if(!e.readOnly)throw new Error("No number change handler provided for non-readonly input")}var Y=function(e){return Object(r.jsx)("input",{className:"numberCellInput",type:"number",min:"0",step:e.step,readOnly:e.readOnly,value:e.number,placeholder:"Set the time",onChange:J(e)})};var z,K=function(e){return Object(r.jsx)("input",{className:"dayOfWeekCellInput",type:"text",readOnly:!0,value:["SUN","MON","TUE","WED","THU","FRI","SAT"][e.dow]})},q=n(9);function G(e){var t=Object(a.useReducer)((function(t,n){return Q(e,t,n)}),E(e.date)),n=Object(s.a)(t,2),r=n[0],o=n[1];return Object(a.useEffect)((function(){return function(e,t){var n=x(p(t)),r=null!==n&&void 0!==n?n:E(t);e({type:z.SetState,value:r}),Object.keys(r.timeTablePropsMap).some((function(e){return void 0===r.timeTablePropsMap[e].timeTablePos}))&&e({type:z.ResetTimeTableOrder})}(o,e.date)}),[e.date]),[r,o]}function Q(e,t,n){switch(n.type){case z.StartTimeUpdate:case z.EndTimeUpdate:case z.BreaksLengthUpdate:case z.IsDayOffUpdate:return V(t,n);case z.SetState:return n.value;case z.AddTimeTable:return function(e,t,n){if(void 0===n.personName)throw new Error("Person name is undefined for time sheet add");if(n.personName in t.timeTablePropsMap)throw new Error("Person name ".concat(n.personName," cannot be added because they already have a time table"));var r=Object.keys(t.timeTablePropsMap).length,a=Object(q.cloneDeep)(t);return a.timeTablePropsMap[n.personName]=I(e,n.personName,r),a}(e,t,n);case z.DeleteTimeTable:return function(e,t){if(void 0===t.personName)throw new Error("Person name is undefined for time sheet delete");if(!(t.personName in e.timeTablePropsMap))throw new Error("Person name ".concat(t.personName," cannot be deleted because they have no time table"));var n=Object(q.cloneDeep)(e);for(;n.timeTablePropsMap[t.personName].timeTablePos!==Object.keys(e.timeTablePropsMap).length-1;)console.log(n.timeTablePropsMap[t.personName].timeTablePos),n=X(n,t.personName);return delete n.timeTablePropsMap[t.personName],n}(t,n);case z.ResetTimeTableOrder:return function(e){var t=Object(q.cloneDeep)(e);return Object.keys(e.timeTablePropsMap).forEach((function(e,n){t.timeTablePropsMap[e].timeTablePos=n})),t}(t);case z.MoveTimeTableUp:return function(e,t){var n=e.timeTablePropsMap[t].timeTablePos;if(void 0===n)throw new Error("Time table position is undefined");if(0===n)return Object(q.cloneDeep)(e);return Z(e,n)}(t,n.personName);case z.MoveTimeTableDown:return X(t,n.personName);default:throw new Error("Action type ".concat(n.type," is not supported by ").concat(Q))}}function V(e,t){if(void 0===t.personName)throw new Error("Person name is undefined for time sheet update");if(void 0===t.dow)throw new Error("Day of week is undefined for time sheet update");var n=e.timeTablePropsMap[t.personName].dayColumnsProps[t.dow],r=Object(N.a)({},n);switch(t.type){case z.StartTimeUpdate:r.startTime=t.value;break;case z.EndTimeUpdate:r.endTime=t.value;break;case z.BreaksLengthUpdate:r.breaksLength=t.value;break;case z.IsDayOffUpdate:r.isDayOff=t.value;break;default:throw new Error("Action type ".concat(t.type," is not supported by ").concat(V))}var a=Object(q.cloneDeep)(e);return a.timeTablePropsMap[t.personName].dayColumnsProps[t.dow]=r,a}function X(e,t){var n=e.timeTablePropsMap[t].timeTablePos;if(void 0===n)throw new Error("Time table position is undefined");return n===Object.keys(e.timeTablePropsMap).length-1?Object(q.cloneDeep)(e):Z(e,n+1)}function Z(e,t){if(!Number.isInteger(t))throw new Error("Time table position ".concat(t," is not an integer"));var n=Object.keys(e.timeTablePropsMap).length;if(t<0||t>=n)throw new Error("Time table position ".concat(t," is less than 0 or greater than ").concat(n));var r=Object(q.cloneDeep)(e);if(0===t)return r;var a=$(r,t),o=$(r,t-1);return a.timeTablePos=t-1,o.timeTablePos=t,r}function $(e,t){if(!Number.isInteger(t))throw new Error("Time table position ".concat(t," is not an integer"));var n=Object.keys(e.timeTablePropsMap).length;if(t<0||t>=n)throw new Error("Time table position ".concat(t," is less than 0 or greater than ").concat(n));var r=Object.values(e.timeTablePropsMap).filter((function(e){return e.timeTablePos===t}));if(1!==r.length)throw new Error("Expected 1 timetable at position ".concat(t,", found ").concat(r.length));return r[0]}!function(e){e[e.StartTimeUpdate=0]="StartTimeUpdate",e[e.EndTimeUpdate=1]="EndTimeUpdate",e[e.BreaksLengthUpdate=2]="BreaksLengthUpdate",e[e.IsDayOffUpdate=3]="IsDayOffUpdate",e[e.SetState=4]="SetState",e[e.ResetTimeTableOrder=5]="ResetTimeTableOrder",e[e.MoveTimeTableUp=6]="MoveTimeTableUp",e[e.MoveTimeTableDown=7]="MoveTimeTableDown",e[e.AddTimeTable=8]="AddTimeTable",e[e.DeleteTimeTable=9]="DeleteTimeTable"}(z||(z={}));var _=function(e){return Object(r.jsx)("input",{className:"checkBoxCellInput",type:"checkbox",value:e.value,onChange:function(){e.onCheckedChange(!e.isChecked)},checked:e.isChecked})};function ee(e){return e.isDayOff?0:e.endTime.getHours()-e.startTime.getHours()-e.breaksLength/60+(e.endTime.getMinutes()-e.startTime.getMinutes())/60+(e.endTime.getSeconds()-e.startTime.getSeconds())/3600}function te(e,t,n,r){if(null===t)throw new Error("Context cannot be null in number change");t.dispatch({personName:e.personName,dow:e.dow,type:n,value:r})}var ne=function e(t){var n,i=Object(a.useContext)(ce);if(null===i)throw new Error("Time sheet context is null in ".concat(e.name));var c=Object(r.jsx)(K,{dow:t.dow},0),s=Object(r.jsx)(_,{isChecked:null!==(n=t.isDayOff)&&void 0!==n&&n,onCheckedChange:function(e){return function(e,t,n){te(e,t,z.IsDayOffUpdate,n)}(t,i,e)},value:t.dow.toString()},5);return t.isDayOff?o.a.Children.toArray([c,Object(r.jsx)(r.Fragment,{}),Object(r.jsx)(r.Fragment,{}),Object(r.jsx)(r.Fragment,{}),Object(r.jsx)(r.Fragment,{}),s]):o.a.Children.toArray([c,Object(r.jsx)(W,{time:t.startTime,onTimeChange:function(e){return function(e,t,n){te(e,t,z.StartTimeUpdate,n)}(t,i,e)}},1),Object(r.jsx)(W,{time:t.endTime,onTimeChange:function(e){return function(e,t,n){te(e,t,z.EndTimeUpdate,n)}(t,i,e)}},2),Object(r.jsx)(Y,{number:t.breaksLength,step:15,onNumberChange:function(e){return function(e,t,n){te(e,t,z.BreaksLengthUpdate,n)}(t,i,e)}},3),Object(r.jsx)(Y,{number:ee(t),readOnly:!0},4),s])},re=[""],ae=["DAY","START","END","UNPAID BREAKS (MINUTES)","DAILY HOURS TOTAL","IS DAY OFF?"];function oe(e){return P.map((function(t){return ee(e.dayColumnsProps[t])})).reduce((function(e,t){return e+t}),0)}var ie=function(e){var t=Object(a.useContext)(ce);if(null===t)throw new Error("Time sheet context is null in ".concat(ne.name));var n,o=P.map((function(t){return e.dayColumnsProps[t]})).map((function(e){return ne(e)})),i=(n=o)[0].map((function(e,t){return n.map((function(e){return e[t]}))})),c=ae.map((function(e,t){return{rowName:e,transposedDayColumnElements:i[t]}}));return Object(r.jsxs)("table",{children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsxs)("th",{scope:"row",children:[re,Object(r.jsx)("button",{onClick:function(){return n=t,r=e.personName,void n.dispatch({type:z.MoveTimeTableUp,personName:r});var n,r},children:"Up"}),Object(r.jsx)("button",{onClick:function(){return n=t,r=e.personName,void n.dispatch({type:z.MoveTimeTableDown,personName:r});var n,r},children:"Down"}),Object(r.jsx)("button",{onClick:function(){return n=t,r=e.personName,void(window.confirm("Are you sure you want to delete the time table for ".concat(r,"?"))&&n.dispatch({type:z.DeleteTimeTable,personName:r}));var n,r},children:"Delete"})]}),Object(r.jsxs)("td",{colSpan:P.length,children:[e.personName,": ",oe(e)," hours"]})]})}),Object(r.jsx)("tbody",{children:c.map((function(e){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{scope:"row",children:e.rowName}),e.transposedDayColumnElements.map((function(e,t){return Object(r.jsx)("td",{children:e},t)}))]},e.rowName)}))})]})},ce=o.a.createContext(null);function se(e){return Object.values(e.timeTablePropsMap).map((function(e){return oe(e)})).reduce((function(e,t){return e+t}),0)}var ue=function(e){var t,n=G(e),i=Object(s.a)(n,2),c=i[0],u=i[1],l={weekStartDate:c.weekStartDate,dispatch:u},d=Object(a.useState)(""),m=Object(s.a)(d,2),b=m[0],p=m[1],f=Object(a.useRef)(null);return Object(r.jsxs)(ce.Provider,{value:l,children:[Object(r.jsxs)("h2",{children:["Week: ",T(e.date)]}),Object(r.jsx)("button",{disabled:(c.weekStartDate,!1),onClick:function(){return function(e,t,n){D(e,t),n(e),window.alert("Successfully saved time sheet for ".concat(T(e)))}(c.weekStartDate,c,e.addTimeSheetDate)},children:"Save Time Sheet To Local Storage"}),Object(r.jsx)("button",{disabled:(c.weekStartDate,t=e.isDeletedTimeSheetDate,!!t),onClick:function(){return function(e,t){window.confirm("Are you sure you want to delete time sheet save data for ".concat(T(e),"?"))&&(t(e),k(e),window.alert("Successfully deleted time sheet save data for ".concat(T(e))))}(c.weekStartDate,e.deleteTimeSheetDate)},children:"Delete Time Sheet From Local Storage"}),Object(r.jsxs)("form",{onSubmit:function(e){return function(e,t,n,r,a,o){if(e.preventDefault(),""===r)return void alert("Cannot add timetable for nameless person");if(Object.keys(t.timeTablePropsMap).some((function(e){return e.toLowerCase()===r.toLowerCase()})))return void alert("Timetable already exists for person ".concat(r));n.dispatch({type:z.AddTimeTable,personName:r}),a(""),o.current.focus()}(e,c,l,b,p,f)},children:[Object(r.jsx)("label",{htmlFor:"person",children:"Person:"}),Object(r.jsx)("input",{name:"person",type:"text",ref:f,value:b,onChange:function(e){return p(e.target.value)}}),Object(r.jsx)("input",{type:"submit",value:"Add new timetable"})]}),Object(r.jsxs)("p",{children:["Total hours working in week: ",se(c)]}),Object.values(c.timeTablePropsMap).sort((function(e,t){return e.timeTablePos-t.timeTablePos})).map((function(e){return Object(r.jsx)("div",{className:"container",children:o.a.createElement(ie,e)},e.personName)}))]})};var le=function(e){var t=Object(l.g)(),n=new Date(t.date);return Object(r.jsxs)(r.Fragment,{children:[e.isDeletedTimeSheetDate(n)&&Object(r.jsx)(l.a,{to:"/"}),Object(r.jsx)("section",{className:"time-sheet",children:Object(r.jsx)(ue,{date:n,addTimeSheetDate:e.addTimeSheetDate,deleteTimeSheetDate:e.deleteTimeSheetDate,isDeletedTimeSheetDate:e.isDeletedTimeSheetDate(n)})})]})};function de(e,t,n){var r=p(n);m(e,r)||(w(r),t(S()))}var me=function(){var e=Object(a.useState)(S()),t=Object(s.a)(e,2),n=t[0],o=t[1];return Object(r.jsx)(u.a,{basename:"/timesheet-maker",children:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("nav",{children:Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)(u.b,{to:"/",children:"Home"})}),n.sort().map((function(e){return Object(r.jsx)("li",{children:Object(r.jsx)(u.b,{to:"/".concat(e.toISOString()),children:T(e,!0)})},e.toISOString())}))]})}),Object(r.jsxs)(l.d,{children:[Object(r.jsx)(l.b,{path:"/:date",children:Object(r.jsx)(le,{isDeletedTimeSheetDate:function(e){return function(e,t){var n=p(t);return!m(e,n)}(n,e)},addTimeSheetDate:function(e){return de(n,o,e)},deleteTimeSheetDate:function(e){return function(e,t,n){var r=p(n);m(e,r)&&(y(r),t(S()))}(n,o,e)}})}),Object(r.jsx)(l.b,{path:"",children:Object(r.jsx)(B,{timeSheetDates:n,addTimeSheetDate:function(e){return de(n,o,e)}})})]})]})})},be=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),o(e),i(e)}))};c.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(me,{})}),document.getElementById("root")),be()}},[[36,1,2]]]);
//# sourceMappingURL=main.0a942b32.chunk.js.map