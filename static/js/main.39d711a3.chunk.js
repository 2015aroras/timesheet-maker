(this["webpackJsonptimesheet-maker"]=this["webpackJsonptimesheet-maker"]||[]).push([[0],{29:function(e,t,n){},30:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),o=n.n(a),c=n(20),i=n.n(c),u=(n(29),n(9)),s=n(2),d=(n(30),n(7)),l=n(22);function m(e,t){return e.toISOString()===t.toISOString()}function p(e){return JSON.parse(e,(function(e,t){return e.toLowerCase().endsWith("date")||e.toLowerCase().endsWith("time")?new Date(t):t}))}function b(e){var t=f(e,-e.getDay());return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function f(e,t,n,r,a){return new Date(e.getTime()+24*(null!==t&&void 0!==t?t:0)*60*60*1e3+60*(null!==n&&void 0!==n?n:0)*60*1e3+60*(null!==r&&void 0!==r?r:0)*1e3+1e3*(null!==a&&void 0!==a?a:0))}function h(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?"/".concat(e.getFullYear()):"";return"".concat(e.getDate(),"/").concat(e.getMonth()+1)+n}var j="timeSheetDates";function S(){var e=localStorage.getItem(j);return null===e?[]:p(e).map((function(e){return new Date(e)}))}function O(e){e.forEach(w),localStorage.setItem(j,JSON.stringify(e))}function g(e){w(e);var t=S();t.some((function(t){return m(e,t)}))||O([e].concat(Object(l.a)(t)))}function v(e){return w(e),S().some((function(t){return m(e,t)}))||null!==localStorage.getItem("timeSheet-".concat(e.toISOString()))}function T(e){return w(e),function(e){w(e),O(S().filter((function(t){return!m(e,t)})))}(e),!!v(e)&&(localStorage.removeItem("timeSheet-".concat(e.toISOString())),!0)}function w(e){if(!m(e,b(e)))throw new Error("Date ".concat(e," does not match start of week ").concat(b(e)))}function y(){var e=Object(a.useState)(new Date(Date.now())),t=Object(d.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),i=Object(d.a)(c,2),u=i[0],l=i[1];return Object(r.jsxs)(r.Fragment,{children:[u&&Object(r.jsx)(s.a,{to:"/".concat(n.toISOString())}),Object(r.jsxs)("form",{onSubmit:function(e){return function(e,t,n){e.preventDefault(),g(b(t)),n(!0)}(e,n,l)},children:[Object(r.jsx)("label",{htmlFor:"date",children:"Date:"}),Object(r.jsx)("input",{name:"date",type:"date",value:x(n),onChange:function(e){return function(e,t){var n=e.target.valueAsDate;if(null===n)throw new Error("Failed to set date in ".concat(y.name));var r=f(n,0,0,n.getTimezoneOffset());t(r)}(e,o)}}),Object(r.jsx)("input",{type:"submit",value:"Add new time sheet"})]})]})}function x(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}var D,N=y;!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(D||(D={}));var C=[D.Sunday,D.Monday,D.Tuesday,D.Wednesday,D.Thursday,D.Friday,D.Saturday];var k=function(e){return Object(r.jsx)("input",{className:"timeCellInput",type:"time",min:"08:00:00",max:"21:00:00",step:900,value:function(e){var t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),r=e.getSeconds().toString().padStart(2,"0");return"".concat(t,":").concat(n,":").concat(r)}(e.time),placeholder:"Set the time",onChange:function(t){return function(t){var n=t.target.valueAsDate;if(null===n)return;var r=new Date(e.time);r.setHours(n.getUTCHours()),r.setMinutes(n.getUTCMinutes()),r.setSeconds(n.getUTCSeconds()),r.setMilliseconds(n.getUTCMilliseconds()),e.onTimeChange(r)}(t)}})};function E(e){if(void 0!==e.onNumberChange)return function(t){e.onNumberChange(t.target.valueAsNumber)};if(!e.readOnly)throw new Error("No number change handler provided for non-readonly input")}var M=function(e){return Object(r.jsx)("input",{className:"numberCellInput",type:"number",min:"0",step:e.step,readOnly:e.readOnly,value:e.number,placeholder:"Set the time",onChange:E(e)})};var P,U=function(e){return Object(r.jsx)("input",{className:"dayOfWeekCellInput",type:"text",readOnly:!0,value:["SUN","MON","TUE","WED","THU","FRI","SAT"][e.dow]})},I=n(23),A=n(13);function L(e,t){return{personName:t,date:e.date,dayColumnsProps:C.reduce((function(n,r){return n[r]=function(e,t,n){var r=f(function(e,t,n,r){var a=new Date(e);return a.setHours(t),a.setMinutes(n),a.setSeconds(r),a.setMilliseconds(0),a}(e.date,8,0,0),n),a=f(r,0,0,30);return{personName:t,dow:n,startTime:r,endTime:a,breaksLength:0}}(e,t,r),n}),{})}}function F(e){var t=Object(a.useReducer)((function(t,n){return H(e,t,n)}),function(e){return{weekStartDate:b(e.date),timeTablePropsMap:{}}}(e)),n=Object(d.a)(t,2),r=n[0],o=n[1];return Object(a.useEffect)((function(){var e=function(e){w(e);var t=localStorage.getItem("timeSheet-".concat(e.toISOString()));return null===t?null:p(t)}(r.weekStartDate);null!==e&&o({type:P.SetState,value:e})}),[]),[r,o]}function H(e,t,n){switch(n.type){case P.StartTimeUpdate:case P.EndTimeUpdate:case P.BreaksLengthUpdate:return B(t,n);case P.SetState:return n.value;case P.AddTimeTable:return function(e,t,n){if(void 0===n.personName)throw new Error("Person name is undefined for time sheet add");if(n.personName in t.timeTablePropsMap)throw new Error("Person name ".concat(n.personName," cannot be added because they already have a time table"));var r=Object(A.cloneDeep)(t);return r.timeTablePropsMap[n.personName]=L(e,n.personName),r}(e,t,n);case P.DeleteTimeTable:return function(e,t){if(void 0===t.personName)throw new Error("Person name is undefined for time sheet delete");if(!(t.personName in e.timeTablePropsMap))throw new Error("Person name ".concat(t.personName," cannot be deleted because they have no time table"));var n=Object(A.cloneDeep)(e);return delete n.timeTablePropsMap[t.personName],n}(t,n);default:throw new Error("Action type ".concat(n.type," is not supported by ").concat(H))}}function B(e,t){if(void 0===t.personName)throw new Error("Person name is undefined for time sheet update");if(void 0===t.dow)throw new Error("Day of week is undefined for time sheet update");var n=e.timeTablePropsMap[t.personName].dayColumnsProps[t.dow],r=Object(I.a)({},n);switch(t.type){case P.StartTimeUpdate:r.startTime=t.value;break;case P.EndTimeUpdate:r.endTime=t.value;break;case P.BreaksLengthUpdate:r.breaksLength=t.value;break;default:throw new Error("Action type ".concat(t.type," is not supported by ").concat(B))}var a=Object(A.cloneDeep)(e);return a.timeTablePropsMap[t.personName].dayColumnsProps[t.dow]=r,a}function R(e){return e.endTime.getHours()-e.startTime.getHours()-e.breaksLength/60+(e.endTime.getMinutes()-e.startTime.getMinutes())/60+(e.endTime.getSeconds()-e.startTime.getSeconds())/3600}function W(e,t,n,r){if(null===t)throw new Error("Context cannot be null in number change");t.dispatch({personName:e.personName,dow:e.dow,type:n,value:r})}!function(e){e[e.StartTimeUpdate=0]="StartTimeUpdate",e[e.EndTimeUpdate=1]="EndTimeUpdate",e[e.BreaksLengthUpdate=2]="BreaksLengthUpdate",e[e.SetState=3]="SetState",e[e.AddTimeTable=4]="AddTimeTable",e[e.DeleteTimeTable=5]="DeleteTimeTable"}(P||(P={}));var J=function e(t){var n=Object(a.useContext)(q);if(null===n)throw new Error("Time sheet context is null in ".concat(e.name));return o.a.Children.toArray([Object(r.jsx)(U,{dow:t.dow},0),Object(r.jsx)(k,{time:t.startTime,onTimeChange:function(e){return function(e,t,n){W(e,t,P.StartTimeUpdate,n)}(t,n,e)}},1),Object(r.jsx)(k,{time:t.endTime,onTimeChange:function(e){return function(e,t,n){W(e,t,P.EndTimeUpdate,n)}(t,n,e)}},2),Object(r.jsx)(M,{number:t.breaksLength,step:15,onNumberChange:function(e){return function(e,t,n){W(e,t,P.BreaksLengthUpdate,n)}(t,n,e)}},3),Object(r.jsx)(M,{number:R(t),readOnly:!0},4)])},Y=["PERSON"],z=["DAY","START","END","UNPAID BREAKS","DAILY HOURS TOTAL"];var K=function(e){var t=Object(a.useContext)(q);if(null===t)throw new Error("Time sheet context is null in ".concat(J.name));var n,o=C.map((function(t){return e.dayColumnsProps[t]})).map((function(e){return J(e)})),c=(n=o)[0].map((function(e,t){return n.map((function(e){return e[t]}))})),i=z.map((function(e,t){return{rowName:e,transposedDayColumnElements:c[t]}}));return Object(r.jsxs)("table",{children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsxs)("th",{scope:"row",children:[Y,Object(r.jsx)("button",{onClick:function(){return n=t,r=e.personName,void n.dispatch({type:P.DeleteTimeTable,personName:r});var n,r},children:"Delete"})]}),Object(r.jsx)("td",{colSpan:C.length,children:e.personName})]})}),Object(r.jsx)("tbody",{children:i.map((function(e){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{scope:"row",children:e.rowName}),e.transposedDayColumnElements.map((function(e,t){return Object(r.jsx)("td",{children:e},t)}))]},e.rowName)}))})]})},q=o.a.createContext(null);function G(e,t){return t}var Q=function(e){var t=F(e),n=Object(d.a)(t,2),c=n[0],i=n[1],u={weekStartDate:c.weekStartDate,dispatch:i},s=Object(a.useState)(""),l=Object(d.a)(s,2),m=l[0],p=l[1],b=Object(a.useRef)(null),f=Object(a.useState)(v(c.weekStartDate)),h=Object(d.a)(f,2),j=h[0],S=h[1];return Object(r.jsxs)(q.Provider,{value:u,children:[Object(r.jsx)("button",{disabled:(c.weekStartDate,!1),onClick:function(){return function(e,t,n){(function(e,t){w(e),localStorage.setItem("timeSheet-".concat(e.toISOString()),JSON.stringify(t)),g(e)})(e,t),n(!0)}(c.weekStartDate,c,S)},children:"Save Time Sheet To Local Storage"}),Object(r.jsx)("button",{disabled:!G(c.weekStartDate,j),onClick:function(){return function(e,t){T(e),t(!1)}(c.weekStartDate,S)},children:"Delete Time Sheet From Local Storage"}),Object(r.jsxs)("form",{onSubmit:function(e){return function(e,t,n,r,a){if(e.preventDefault(),""===n)return void alert("Cannot add timetable for nameless person");t.dispatch({type:P.AddTimeTable,personName:n}),r(""),a.current.focus()}(e,u,m,p,b)},children:[Object(r.jsx)("label",{htmlFor:"person",children:"Person:"}),Object(r.jsx)("input",{name:"person",type:"text",ref:b,value:m,onChange:function(e){return p(e.target.value)}}),Object(r.jsx)("input",{type:"submit",value:"Add new timetable"})]}),Object.keys(c.timeTablePropsMap).map((function(e){return Object(r.jsx)("div",{className:"container",children:o.a.createElement(K,c.timeTablePropsMap[e])},e)}))]})};var V=function(){var e=Object(s.g)(),t=new Date(e.date);return Object(r.jsx)("section",{className:"time-sheet",children:Object(r.jsx)(Q,{date:t})})},X="/timesheet-maker";var Z=function(){var e=S();return Object(r.jsx)(u.a,{children:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("nav",{children:Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)(u.b,{to:X,children:"Home"})}),e.sort().map((function(e){return Object(r.jsx)("li",{children:Object(r.jsxs)(u.b,{to:"".concat(X,"/").concat(e.toISOString()),children:[h(e,!0)," \u2013 ",h(f(e,7),!0)]})},e.toISOString())}))]})}),Object(r.jsxs)(s.d,{children:[Object(r.jsx)(s.b,{path:"".concat(X,"/:date"),children:Object(r.jsx)(V,{})}),Object(r.jsx)(s.b,{path:X,children:Object(r.jsx)(N,{})})]})]})})},$=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),o(e),c(e)}))};i.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(Z,{})}),document.getElementById("root")),$()}},[[36,1,2]]]);
//# sourceMappingURL=main.39d711a3.chunk.js.map